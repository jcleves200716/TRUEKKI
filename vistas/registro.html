<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Registro</title>
    <link rel="stylesheet" href="../css/resgistro.css">
</head>
<body>
  <!-- Panel izquierdo -->
  <div class="left-panel"></div>

  <!-- Panel derecho -->
  <div class="right-panel">
      <div class="avatar">ğŸ‘¤</div>
      <div class="register-title">REGISTRO</div>

      <!-- FORMULARIO -->
      <form id="registroForm">
        <div class="input-group">
          <i>ğŸ‘¤</i>
          <input type="text" name="nombre" placeholder="Nombre completo" required>
        </div>

        <div class="input-group">
          <i>ğŸ“§</i>
          <input type="email" name="email" placeholder="Email" required>
        </div>

        <div class="input-group">
          <i>ğŸ”’</i>
          <input type="password" id="password" name="password" placeholder="ContraseÃ±a" required>
          <span class="toggle-password" data-target="password">
            <img src="../img/ojo-cerrado.png" class="ojo" alt="Ver contraseÃ±a">
          </span>
        </div>

        <div class="input-group">
          <i>ğŸ”’</i>
          <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirmar contraseÃ±a" required>
          <span class="toggle-password" data-target="confirmPassword">
            <img src="../img/ojo-cerrado.png" class="ojo" alt="Ver contraseÃ±a">
          </span>
        </div>
        <div class="error-message" id="passwordError">Las contraseÃ±as no coinciden</div>

        <div class="password-requirements">
          <h4>La contraseÃ±a debe contener:</h4>
          <div class="requirement" id="req-length">
            <span>â€¢ MÃ­nimo 8 caracteres</span>
          </div>
          <div class="requirement" id="req-uppercase">
            <span>â€¢ Al menos una letra mayÃºscula</span>
          </div>
          <div class="requirement" id="req-number">
            <span>â€¢ Al menos un nÃºmero</span>
          </div>
          <div class="requirement" id="req-special">
            <span>â€¢ Al menos un carÃ¡cter especial (@$!%*?&)</span>
          </div>
        </div>

        <div class="input-group">
          <i>ğŸ“</i>
          <input type="text" name="telefono" placeholder="NÃºmero de contacto">
        </div>

        <div class="input-group">
          <i>ğŸ </i>
          <input type="text" name="direccion" placeholder="DirecciÃ³n">
        </div>

        <div class="button-group">
          <button type="submit" class="btn" id="submitBtn">REGISTRARSE</button>
          <button type="button" class="btn1">
            <a href="login.html">Â¿Ya tienes cuenta?</a>
          </button>
        </div>
        
        <div class="spinner" id="spinner"></div>
        <div class="error-message" id="formError"></div>
        <div class="success-message" id="successMessage">Â¡Registro exitoso! Redirigiendo al login...</div>
      </form>
    
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // FunciÃ³n para mostrar/ocultar contraseÃ±a
      document.querySelectorAll(".toggle-password").forEach(toggle => {
        toggle.addEventListener("click", function () {
          const inputId = this.getAttribute("data-target");
          const input = document.getElementById(inputId);
          const img = this.querySelector("img");

          if (input.type === "password") {
            input.type = "text";
            // Cambiar a icono de ojo abierto (SVG en base64)
            img.src ="../img/ojo-abierto.png";
          } else {
            input.type = "password";
            // Cambiar a icono de ojo cerrado (SVG en base64)
            img.src = "../img/ojo-cerrado.png";
          }
        });
      });

      // Elementos DOM
      const password = document.getElementById('password');
      const confirmPassword = document.getElementById('confirmPassword');
      const passwordError = document.getElementById('passwordError');
      const formError = document.getElementById('formError');
      const successMessage = document.getElementById('successMessage');
      const spinner = document.getElementById('spinner');
      const submitBtn = document.getElementById('submitBtn');
      
      // Elementos de requisitos
      const reqLength = document.getElementById('req-length');
      const reqUppercase = document.getElementById('req-uppercase');
      const reqNumber = document.getElementById('req-number');
      const reqSpecial = document.getElementById('req-special');

      // Validar fortaleza de la contraseÃ±a
      function validatePasswordStrength(pwd) {
        // Longitud mÃ­nima de 8 caracteres
        const hasMinLength = pwd.length >= 8;
        
        // Al menos una letra mayÃºscula
        const hasUppercase = /[A-Z]/.test(pwd);
        
        // Al menos un nÃºmero
        const hasNumber = /[0-9]/.test(pwd);
        
        // Al menos un carÃ¡cter especial
        const hasSpecial = /[@$!%*?&]/.test(pwd);
        
        return {
          valid: hasMinLength && hasUppercase && hasNumber && hasSpecial,
          hasMinLength,
          hasUppercase,
          hasNumber,
          hasSpecial
        };
      }

      // Actualizar la visualizaciÃ³n de requisitos
      function updateRequirementsUI(strength) {
        // Actualizar cada requisito
        reqLength.className = strength.hasMinLength ? 'requirement valid' : 'requirement invalid';
        reqUppercase.className = strength.hasUppercase ? 'requirement valid' : 'requirement invalid';
        reqNumber.className = strength.hasNumber ? 'requirement valid' : 'requirement invalid';
        reqSpecial.className = strength.hasSpecial ? 'requirement valid' : 'requirement invalid';
      }

      // Validar que las contraseÃ±as coincidan
      function validatePassword() {
        const pwdValue = password.value;
        const confirmValue = confirmPassword.value;
        
        // Validar fortaleza
        const strength = validatePasswordStrength(pwdValue);
        updateRequirementsUI(strength);
        
        // Validar coincidencia
        if (pwdValue !== confirmValue && confirmValue !== '') {
          passwordError.style.display = 'block';
          return false;
        } else {
          passwordError.style.display = 'none';
          return strength.valid;
        }
      }

      // Event listeners para validaciÃ³n en tiempo real
      password.addEventListener('input', function() {
        const strength = validatePasswordStrength(this.value);
        updateRequirementsUI(strength);
        validatePassword();
      });

      confirmPassword.addEventListener('input', validatePassword);

      // Manejo del envÃ­o del formulario
      document.getElementById('registroForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // Validar contraseÃ±as
        if (!validatePassword()) {
          formError.textContent = 'Por favor, corrige los errores en la contraseÃ±a.';
          formError.style.display = 'block';
          return;
        }
        
        // Ocultar mensajes anteriores
        formError.style.display = 'none';
        successMessage.style.display = 'none';
        
        // Mostrar spinner y deshabilitar botÃ³n
        spinner.style.display = 'block';
        submitBtn.disabled = true;
        
        // Simular envÃ­o al servidor (en un caso real, aquÃ­ harÃ­as una peticiÃ³n fetch)
        setTimeout(() => {
          spinner.style.display = 'none';
          successMessage.style.display = 'block';
          
          // Redirigir despuÃ©s de 2 segundos
          setTimeout(() => {
            window.location.href = 'login.html';
          }, 2000);
        }, 1500);
      });
    });
  </script>
</body>
</html>